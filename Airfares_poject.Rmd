---
title: "R Notebook"
output: html_notebook
---

# Airline Fares

```{r}
library(dplyr)
library(readr)
library(GGally)
library(car)
```

## Read the data
```{r}
airfares <- read_csv('https://raw.githubusercontent.com/rosagradilla19/Airfares/master/Airfares.csv')
head(airfares)
```

## Data Exploration
```{r}
airfares.num <- airfares %>% select(COUPON, NEW, HI, S_INCOME, E_INCOME, S_POP, E_POP, DISTANCE, PAX, FARE)
airfares.cat <- airfares %>% select(S_CODE,S_CITY,E_CODE,E_CITY,VACATION,SW,SLOT,GATE,)
p <- ggpairs(airfares.num,
             columns= c(1,3,4,6,8,9,10),
             progress = FALSE
            )
p
```


```{r}
library(corrplot)
cordata <- cor(airfares.num)
corrplot(cordata, method='number')
```

# Multiple Linear Regression

What variables play a significant role in determining a flight's fare. Response variable is flight fare.

$fare_i=coupon_i+new_i+D_{vacation,i}+HI_i+s.income_i+e.income_i+s.pop_i+e.pop_i+distance_i+pax_i+\varepsilon_i, \varepsilon_i\sim_{i.i.d}(0,\sigma^2)$

```{r}
# fitting model to all predictors
mlr <- lm(FARE ~ COUPON + NEW + VACATION + HI + S_INCOME + E_INCOME + S_POP + E_POP + DISTANCE + PAX, data=airfares)
summary(mlr)
```

```{r}
# check for collinearity
vif(mlr)
```

```{r}
# variable selection
step(mlr)
```

```{r}
mlr2 <- lm(FARE ~ COUPON + VACATION + HI + S_INCOME + E_INCOME + S_POP + E_POP + DISTANCE + PAX, data=airfares)
summary(mlr2) 
```

$fare_i=coupon_i+D_{vacation,i}+HI_i+s.income_i+e.income_i+s.pop_i+e.pop_i+distance_i+pax_i+\varepsilon_i, \varepsilon_i\sim_{i.i.d}(0,\sigma^2)$



